<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="de" th:lang="${lang}">
  <head th:replace="~{timeentries/_layout::head(~{::title}, ~{}, ~{}, ~{})}">
    <title>Zeiterfassung - Personen</title>
  </head>
  <body th:replace="~{timeentries/_layout::body(~{::content})}">
    <th:block th:fragment="content">
      <main class="grow">
        <div
          class="mx-auto w-full px-8 max-w-screen-xl 3xl:px-4 3xl:max-w-screen-3xl"
        >
          <h1 class="text-xl font-bold">Personen</h1>
          <p class="mt-2 text-gray-600">
            Information: Es werden hier nur Personen angezeigt, welche sich
            mindestens einmal in der Zeiterfassung angemeldet haben.
          </p>
          <div class="mt-12 flex gap-4">
            <div class="w-1/3 border border-gray-100 bg-white rounded-xl p-4">
              <ol class="flex flex-col">
                <th:block th:each="user : ${users}">
                  <li>
                    <div
                      class="py-3 px-2 flex items-center justify-between gap-4 rounded-xl transition-colors"
                      th:classappend="${selectedUser != null && selectedUser.id eq user.id ? 'bg-gray-100' : 'hover:bg-gray-50'}"
                    >
                      <span class="text-blue-300">
                        <img
                          alt=""
                          th:replace="~{fragments/avatar::avatar(${user.fullName},48,48)}"
                        />
                      </span>
                      <a
                        href="#"
                        th:href="@{/users/{id} (id=${user.id})}"
                        class="flex-1 flex items-center justify-between gap-4"
                      >
                        <span class="flex flex-col">
                          <span
                            class="text-black"
                            th:text="${user.fullName}"
                          ></span>
                          <span
                            class="text-gray-400"
                            th:text="${user.email}"
                          ></span>
                        </span>
                        <svg
                          th:replace="~{icons/chevron-right::svg(className='w-6 h-6 text-gray-400')}"
                        ></svg>
                      </a>
                    </div>
                  </li>
                  <li th:if="${not userStat.last}" role="separator">
                    <div class="bg-gray-100 h-px mx-2"></div>
                  </li>
                </th:block>
              </ol>
            </div>
            <div
              class="flex-1 border border-gray-100 bg-blue-50 rounded-xl overflow-hidden flex"
            >
              <div
                th:if="${selectedUser == null}"
                class="flex-1 flex items-center justify-center"
              >
                <p class="text-xl">Wähle eine Person aus.</p>
              </div>
              <div th:if="${selectedUser}" class="w-full">
                <h2 class="sr-only" th:text="${selectedUser.fullName}"></h2>
                <div class="p-4 flex items-center gap-4">
                  <span class="text-blue-300">
                    <img
                      alt=""
                      th:replace="~{fragments/avatar::avatar(${selectedUser.fullName},64, 64)}"
                    />
                  </span>
                  <span class="flex flex-col">
                    <span
                      class="text-black font-bold"
                      th:text="${selectedUser.fullName}"
                    ></span>
                    <span
                      class="text-gray-400"
                      th:text="${selectedUser.email}"
                    ></span>
                  </span>
                </div>
                <div class="p-6 bg-white">
                  <form
                    action="#"
                    th:action="@{/users/{userId}/working-time (userId=${selectedUser.id})}"
                    method="post"
                    class="flex flex-col gap-8"
                    th:object="${workingTime}"
                  >
                    <fieldset class="border-t border-gray-100">
                      <legend class="text-sm font-medium text-gray-400">
                        Arbeitstage
                      </legend>
                      <div class="mt-2">
                        <ul class="flex gap-4">
                          <li
                            class="flex items-center gap-1"
                            th:fragment="workday(dayOfWeek)"
                            th:with="dayOfWeek=${dayOfWeek ?: 'monday'}"
                          >
                            <input
                              type="checkbox"
                              name="workday"
                              value="monday"
                              th:value="${dayOfWeek}"
                              id="workday-monday"
                              th:id="${'workday-' + dayOfWeek}"
                              th:checked="${#lists.contains(workingTime.workday, dayOfWeek)}"
                            />
                            <label
                              for="workday-monday"
                              th:for="${'workday-' + dayOfWeek}"
                              th:text="${#messages.msg(dayOfWeek.toUpperCase())}"
                            >
                              Montag
                            </label>
                          </li>
                          <li th:replace="::workday('tuesday')"></li>
                          <li th:replace="::workday('wednesday')"></li>
                          <li th:replace="::workday('thursday')"></li>
                          <li th:replace="::workday('friday')"></li>
                          <li th:replace="::workday('saturday')"></li>
                          <li th:replace="::workday('sunday')"></li>
                        </ul>
                      </div>
                    </fieldset>
                    <div
                      class="p-4 rounded-md text-red-900 border border-red-100 bg-red-50"
                      th:if="${#fields.hasErrors('workingTimeClash')}"
                    >
                      <p th:text="${#fields.errors('workingTimeClash')[0]}">
                        Arbeitszeit Fehlernachricht.
                      </p>
                    </div>
                    <fieldset
                      class="border-t border-gray-100"
                      th:classappend="${#fields.hasErrors('workingTimeClash') ? 'border-red-600' : ''}"
                    >
                      <legend
                        class="text-sm font-medium text-gray-400"
                        th:classappend="${#fields.hasErrors('workingTimeClash') ? 'text-red-600' : ''}"
                      >
                        Arbeitszeit
                      </legend>
                      <div class="mt-2">
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTime"
                            id="input-workingtime"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTime}"
                            th:errorclass="invalid"
                          />
                          <label for="input-workingtime">Stunden am Tag</label>
                          <p
                            th:if="${#fields.hasErrors('workingTime')}"
                            th:text="${#fields.errors('workingTime')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                      </div>
                    </fieldset>
                    <fieldset
                      class="border-t border-gray-100"
                      th:classappend="${#fields.hasErrors('workingTimeClash') ? 'border-red-400' : ''}"
                    >
                      <legend
                        class="text-sm font-medium text-gray-400"
                        th:classappend="${#fields.hasErrors('workingTimeClash') ? 'text-red-600' : ''}"
                      >
                        Individuelle Arbeitszeit
                      </legend>
                      <div class="mt-2 space-y-2">
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTimeMonday"
                            id="input-working-time-monday"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTimeMonday}"
                            th:errorclass="invalid"
                          />
                          <label for="input-working-time-monday">
                            Stunden am Montag
                          </label>
                          <p
                            th:if="${#fields.hasErrors('workingTimeMonday')}"
                            th:text="${#fields.errors('workingTimeMonday')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTimeTuesday"
                            id="input-working-time-tuesday"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTimeTuesday}"
                            th:errorclass="invalid"
                          />
                          <label for="input-working-time-tuesday">
                            Stunden am Dienstag
                          </label>
                          <p
                            th:if="${#fields.hasErrors('workingTimeTuesday')}"
                            th:text="${#fields.errors('workingTimeTuesday')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTimeWednesday"
                            id="input-working-time-wednesday"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTimeWednesday}"
                            th:errorclass="invalid"
                          />
                          <label for="input-working-time-wednesday">
                            Stunden am Mittwoch
                          </label>
                          <p
                            th:if="${#fields.hasErrors('workingTimeWednesday')}"
                            th:text="${#fields.errors('workingTimeWednesday')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTimeThursday"
                            id="input-working-time-thursday"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTimeThursday}"
                            th:errorclass="invalid"
                          />
                          <label for="input-working-time-thursday">
                            Stunden am Donnerstag
                          </label>
                          <p
                            th:if="${#fields.hasErrors('workingTimeThursday')}"
                            th:text="${#fields.errors('workingTimeThursday')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTimeFriday"
                            id="input-working-time-friday"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTimeFriday}"
                            th:errorclass="invalid"
                          />
                          <label for="input-working-time-friday">
                            Stunden am Freitag
                          </label>
                          <p
                            th:if="${#fields.hasErrors('workingTimeFriday')}"
                            th:text="${#fields.errors('workingTimeFriday')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTimeSaturday"
                            id="input-working-time-saturday"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTimeSaturday}"
                            th:errorclass="invalid"
                          />
                          <label for="input-working-time-saturday">
                            Stunden am Samstag
                          </label>
                          <p
                            th:if="${#fields.hasErrors('workingTimeSaturday')}"
                            th:text="${#fields.errors('workingTimeSaturday')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                        <div class="space-x-1">
                          <input
                            type="text"
                            inputmode="numeric"
                            name="workingTimeSunday"
                            id="input-working-time-sunday"
                            class="border border-gray-300 px-2 py-1 w-14"
                            th:field="*{workingTimeSunday}"
                            th:errorclass="invalid"
                          />
                          <label for="input-working-time-sunday">
                            Stunden am Sonntag
                          </label>
                          <p
                            th:if="${#fields.hasErrors('workingTimeSunday')}"
                            th:text="${#fields.errors('workingTimeSunday')[0]}"
                            class="mt-2 invalid"
                          ></p>
                        </div>
                      </div>
                    </fieldset>
                    <div class="mt-8 flex items-center gap-2">
                      <button
                        type="submit"
                        class="bg-blue-700 border border-blue-700 text-white font-medium rounded px-4 py-2 flex items-center gap-2"
                      >
                        <svg
                          th:replace="icons/save::svg(className='w-5 h-5')"
                        ></svg>
                        Aktualisieren
                      </button>
                      <button
                        type="reset"
                        class="whitespace-nowrap border border-blue-700 text-blue-700 font-medium rounded px-4 py-2"
                      >
                        Änderungen verwerfen
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </th:block>
  </body>
</html>
